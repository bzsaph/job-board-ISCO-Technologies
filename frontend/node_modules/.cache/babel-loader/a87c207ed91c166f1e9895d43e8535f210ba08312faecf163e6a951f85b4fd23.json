{"ast":null,"code":"import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';import api from'../../services/api';export function setAuthToken(token){if(token)api.defaults.headers.common['Authorization']=\"Bearer \".concat(token);else delete api.defaults.headers.common['Authorization'];}// Fetch all jobs (public)\nexport const fetchJobs=createAsyncThunk('jobs/fetch',async function(){let params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';const res=await api.get(\"/jobs\".concat(params));return res.data;});// Fetch single job (public)\nexport const fetchJob=createAsyncThunk('jobs/fetchOne',async id=>{const res=await api.get(\"/jobs/\".concat(id));return res.data;});// Create job (requires auth)\nexport const createJob=createAsyncThunk('jobs/create',async(payload,_ref)=>{let{getState}=_ref;const token=getState().auth.token;console.log(getState().auth.token);if(!token)throw new Error('Not logged in');setAuthToken(token);// ensure axios has it globally\nconst res=await api.post('/jobs',payload);// no need to pass headers here\n// ...............................\nconsole.log(\"...............................\",res.data);return res.data;});// Update job (requires auth)\nexport const updateJob=createAsyncThunk('jobs/update',async(_ref2,_ref3)=>{let{id,data}=_ref2;let{getState}=_ref3;const token=getState().auth.token;if(!token)throw new Error('Not logged in');const res=await api.put(\"/jobs/\".concat(id),data,{headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'application/json'}});return res.data;});// Delete job (requires auth)\nexport const deleteJob=createAsyncThunk('jobs/delete',async(id,_ref4)=>{let{getState}=_ref4;const token=getState().auth.token;if(!token)throw new Error('Not logged in');await api.delete(\"/jobs/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)}});return id;});const slice=createSlice({name:'jobs',initialState:{list:[],current:null,status:'idle',error:null},reducers:{},extraReducers:builder=>{builder.addCase(fetchJobs.fulfilled,(state,action)=>{state.list=action.payload;state.error=null;}).addCase(fetchJobs.rejected,(state,action)=>{state.error=action.error.message;}).addCase(fetchJob.fulfilled,(state,action)=>{state.current=action.payload;state.error=null;}).addCase(fetchJob.rejected,(state,action)=>{state.error=action.error.message;}).addCase(createJob.fulfilled,(state,action)=>{state.list.unshift(action.payload);state.error=null;}).addCase(createJob.rejected,(state,action)=>{state.error=action.error.message;}).addCase(updateJob.fulfilled,(state,action)=>{state.list=state.list.map(j=>j.id===action.payload.id?action.payload:j);state.current=action.payload;state.error=null;}).addCase(updateJob.rejected,(state,action)=>{state.error=action.error.message;}).addCase(deleteJob.fulfilled,(state,action)=>{state.list=state.list.filter(j=>j.id!==action.payload);state.error=null;}).addCase(deleteJob.rejected,(state,action)=>{state.error=action.error.message;});}});export default slice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","setAuthToken","token","defaults","headers","common","concat","fetchJobs","params","arguments","length","undefined","res","get","data","fetchJob","id","createJob","payload","_ref","getState","auth","console","log","Error","post","updateJob","_ref2","_ref3","put","Authorization","deleteJob","_ref4","delete","slice","name","initialState","list","current","status","error","reducers","extraReducers","builder","addCase","fulfilled","state","action","rejected","message","unshift","map","j","filter","reducer"],"sources":["D:/fullstacker/job-board/frontend/src/store/slices/jobsSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport api from '../../services/api';\nexport function setAuthToken(token) {\n\n  if (token) api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n \n  else delete api.defaults.headers.common['Authorization'];\n  \n}\n\n\n// Fetch all jobs (public)\nexport const fetchJobs = createAsyncThunk('jobs/fetch', async (params = '') => {\n  const res = await api.get(`/jobs${params}`);\n  return res.data;\n});\n\n// Fetch single job (public)\nexport const fetchJob = createAsyncThunk('jobs/fetchOne', async (id) => {\n  const res = await api.get(`/jobs/${id}`);\n  return res.data;\n});\n\n// Create job (requires auth)\nexport const createJob = createAsyncThunk(\n  'jobs/create',\n  async (payload, { getState }) => {\n    const token = getState().auth.token;\n    console.log(getState().auth.token);\n    if (!token) throw new Error('Not logged in');\n\n    setAuthToken(token); // ensure axios has it globally\n    const res = await api.post('/jobs', payload); // no need to pass headers here\n    // ...............................\n    console.log(\"...............................\",res.data);\n    return res.data;\n  }\n);\n\n\n// Update job (requires auth)\nexport const updateJob = createAsyncThunk(\n  'jobs/update',\n  async ({ id, data }, { getState }) => {\n    const token = getState().auth.token;\n    if (!token) throw new Error('Not logged in');\n\n    const res = await api.put(`/jobs/${id}`, data, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'application/json',\n      },\n    });\n    return res.data;\n  }\n);\n\n// Delete job (requires auth)\nexport const deleteJob = createAsyncThunk(\n  'jobs/delete',\n  async (id, { getState }) => {\n    const token = getState().auth.token;\n    if (!token) throw new Error('Not logged in');\n\n    await api.delete(`/jobs/${id}`, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n    return id;\n  }\n);\n\nconst slice = createSlice({\n  name: 'jobs',\n  initialState: { list: [], current: null, status: 'idle', error: null },\n  reducers: {},\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchJobs.fulfilled, (state, action) => {\n        state.list = action.payload;\n        state.error = null;\n      })\n      .addCase(fetchJobs.rejected, (state, action) => {\n        state.error = action.error.message;\n      })\n      .addCase(fetchJob.fulfilled, (state, action) => {\n        state.current = action.payload;\n        state.error = null;\n      })\n      .addCase(fetchJob.rejected, (state, action) => {\n        state.error = action.error.message;\n      })\n      .addCase(createJob.fulfilled, (state, action) => {\n        state.list.unshift(action.payload);\n        state.error = null;\n      })\n      .addCase(createJob.rejected, (state, action) => {\n        state.error = action.error.message;\n      })\n      .addCase(updateJob.fulfilled, (state, action) => {\n        state.list = state.list.map(j => j.id === action.payload.id ? action.payload : j);\n        state.current = action.payload;\n        state.error = null;\n      })\n      .addCase(updateJob.rejected, (state, action) => {\n        state.error = action.error.message;\n      })\n      .addCase(deleteJob.fulfilled, (state, action) => {\n        state.list = state.list.filter(j => j.id !== action.payload);\n        state.error = null;\n      })\n      .addCase(deleteJob.rejected, (state, action) => {\n        state.error = action.error.message;\n      });\n  },\n});\n\n\nexport default slice.reducer;\n"],"mappings":"AAAA,OAASA,WAAW,CAAEC,gBAAgB,KAAQ,kBAAkB,CAChE,MAAO,CAAAC,GAAG,KAAM,oBAAoB,CACpC,MAAO,SAAS,CAAAC,YAAYA,CAACC,KAAK,CAAE,CAElC,GAAIA,KAAK,CAAEF,GAAG,CAACG,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,WAAAC,MAAA,CAAaJ,KAAK,CAAE,CAAC,IAEvE,OAAO,CAAAF,GAAG,CAACG,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,CAE1D,CAGA;AACA,MAAO,MAAM,CAAAE,SAAS,CAAGR,gBAAgB,CAAC,YAAY,CAAE,gBAAuB,IAAhB,CAAAS,MAAM,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CACxE,KAAM,CAAAG,GAAG,CAAG,KAAM,CAAAZ,GAAG,CAACa,GAAG,SAAAP,MAAA,CAASE,MAAM,CAAE,CAAC,CAC3C,MAAO,CAAAI,GAAG,CAACE,IAAI,CACjB,CAAC,CAAC,CAEF;AACA,MAAO,MAAM,CAAAC,QAAQ,CAAGhB,gBAAgB,CAAC,eAAe,CAAE,KAAO,CAAAiB,EAAE,EAAK,CACtE,KAAM,CAAAJ,GAAG,CAAG,KAAM,CAAAZ,GAAG,CAACa,GAAG,UAAAP,MAAA,CAAUU,EAAE,CAAE,CAAC,CACxC,MAAO,CAAAJ,GAAG,CAACE,IAAI,CACjB,CAAC,CAAC,CAEF;AACA,MAAO,MAAM,CAAAG,SAAS,CAAGlB,gBAAgB,CACvC,aAAa,CACb,MAAOmB,OAAO,CAAAC,IAAA,GAAmB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC1B,KAAM,CAAAjB,KAAK,CAAGkB,QAAQ,CAAC,CAAC,CAACC,IAAI,CAACnB,KAAK,CACnCoB,OAAO,CAACC,GAAG,CAACH,QAAQ,CAAC,CAAC,CAACC,IAAI,CAACnB,KAAK,CAAC,CAClC,GAAI,CAACA,KAAK,CAAE,KAAM,IAAI,CAAAsB,KAAK,CAAC,eAAe,CAAC,CAE5CvB,YAAY,CAACC,KAAK,CAAC,CAAE;AACrB,KAAM,CAAAU,GAAG,CAAG,KAAM,CAAAZ,GAAG,CAACyB,IAAI,CAAC,OAAO,CAAEP,OAAO,CAAC,CAAE;AAC9C;AACAI,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAACX,GAAG,CAACE,IAAI,CAAC,CACvD,MAAO,CAAAF,GAAG,CAACE,IAAI,CACjB,CACF,CAAC,CAGD;AACA,MAAO,MAAM,CAAAY,SAAS,CAAG3B,gBAAgB,CACvC,aAAa,CACb,MAAA4B,KAAA,CAAAC,KAAA,GAAsC,IAA/B,CAAEZ,EAAE,CAAEF,IAAK,CAAC,CAAAa,KAAA,IAAE,CAAEP,QAAS,CAAC,CAAAQ,KAAA,CAC/B,KAAM,CAAA1B,KAAK,CAAGkB,QAAQ,CAAC,CAAC,CAACC,IAAI,CAACnB,KAAK,CACnC,GAAI,CAACA,KAAK,CAAE,KAAM,IAAI,CAAAsB,KAAK,CAAC,eAAe,CAAC,CAE5C,KAAM,CAAAZ,GAAG,CAAG,KAAM,CAAAZ,GAAG,CAAC6B,GAAG,UAAAvB,MAAA,CAAUU,EAAE,EAAIF,IAAI,CAAE,CAC7CV,OAAO,CAAE,CACP0B,aAAa,WAAAxB,MAAA,CAAYJ,KAAK,CAAE,CAChC,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CACF,MAAO,CAAAU,GAAG,CAACE,IAAI,CACjB,CACF,CAAC,CAED;AACA,MAAO,MAAM,CAAAiB,SAAS,CAAGhC,gBAAgB,CACvC,aAAa,CACb,MAAOiB,EAAE,CAAAgB,KAAA,GAAmB,IAAjB,CAAEZ,QAAS,CAAC,CAAAY,KAAA,CACrB,KAAM,CAAA9B,KAAK,CAAGkB,QAAQ,CAAC,CAAC,CAACC,IAAI,CAACnB,KAAK,CACnC,GAAI,CAACA,KAAK,CAAE,KAAM,IAAI,CAAAsB,KAAK,CAAC,eAAe,CAAC,CAE5C,KAAM,CAAAxB,GAAG,CAACiC,MAAM,UAAA3B,MAAA,CAAUU,EAAE,EAAI,CAC9BZ,OAAO,CAAE,CACP0B,aAAa,WAAAxB,MAAA,CAAYJ,KAAK,CAChC,CACF,CAAC,CAAC,CACF,MAAO,CAAAc,EAAE,CACX,CACF,CAAC,CAED,KAAM,CAAAkB,KAAK,CAAGpC,WAAW,CAAC,CACxBqC,IAAI,CAAE,MAAM,CACZC,YAAY,CAAE,CAAEC,IAAI,CAAE,EAAE,CAAEC,OAAO,CAAE,IAAI,CAAEC,MAAM,CAAE,MAAM,CAAEC,KAAK,CAAE,IAAK,CAAC,CACtEC,QAAQ,CAAE,CAAC,CAAC,CACZC,aAAa,CAAGC,OAAO,EAAK,CAC1BA,OAAO,CACJC,OAAO,CAACrC,SAAS,CAACsC,SAAS,CAAE,CAACC,KAAK,CAAEC,MAAM,GAAK,CAC/CD,KAAK,CAACT,IAAI,CAAGU,MAAM,CAAC7B,OAAO,CAC3B4B,KAAK,CAACN,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDI,OAAO,CAACrC,SAAS,CAACyC,QAAQ,CAAE,CAACF,KAAK,CAAEC,MAAM,GAAK,CAC9CD,KAAK,CAACN,KAAK,CAAGO,MAAM,CAACP,KAAK,CAACS,OAAO,CACpC,CAAC,CAAC,CACDL,OAAO,CAAC7B,QAAQ,CAAC8B,SAAS,CAAE,CAACC,KAAK,CAAEC,MAAM,GAAK,CAC9CD,KAAK,CAACR,OAAO,CAAGS,MAAM,CAAC7B,OAAO,CAC9B4B,KAAK,CAACN,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDI,OAAO,CAAC7B,QAAQ,CAACiC,QAAQ,CAAE,CAACF,KAAK,CAAEC,MAAM,GAAK,CAC7CD,KAAK,CAACN,KAAK,CAAGO,MAAM,CAACP,KAAK,CAACS,OAAO,CACpC,CAAC,CAAC,CACDL,OAAO,CAAC3B,SAAS,CAAC4B,SAAS,CAAE,CAACC,KAAK,CAAEC,MAAM,GAAK,CAC/CD,KAAK,CAACT,IAAI,CAACa,OAAO,CAACH,MAAM,CAAC7B,OAAO,CAAC,CAClC4B,KAAK,CAACN,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDI,OAAO,CAAC3B,SAAS,CAAC+B,QAAQ,CAAE,CAACF,KAAK,CAAEC,MAAM,GAAK,CAC9CD,KAAK,CAACN,KAAK,CAAGO,MAAM,CAACP,KAAK,CAACS,OAAO,CACpC,CAAC,CAAC,CACDL,OAAO,CAAClB,SAAS,CAACmB,SAAS,CAAE,CAACC,KAAK,CAAEC,MAAM,GAAK,CAC/CD,KAAK,CAACT,IAAI,CAAGS,KAAK,CAACT,IAAI,CAACc,GAAG,CAACC,CAAC,EAAIA,CAAC,CAACpC,EAAE,GAAK+B,MAAM,CAAC7B,OAAO,CAACF,EAAE,CAAG+B,MAAM,CAAC7B,OAAO,CAAGkC,CAAC,CAAC,CACjFN,KAAK,CAACR,OAAO,CAAGS,MAAM,CAAC7B,OAAO,CAC9B4B,KAAK,CAACN,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDI,OAAO,CAAClB,SAAS,CAACsB,QAAQ,CAAE,CAACF,KAAK,CAAEC,MAAM,GAAK,CAC9CD,KAAK,CAACN,KAAK,CAAGO,MAAM,CAACP,KAAK,CAACS,OAAO,CACpC,CAAC,CAAC,CACDL,OAAO,CAACb,SAAS,CAACc,SAAS,CAAE,CAACC,KAAK,CAAEC,MAAM,GAAK,CAC/CD,KAAK,CAACT,IAAI,CAAGS,KAAK,CAACT,IAAI,CAACgB,MAAM,CAACD,CAAC,EAAIA,CAAC,CAACpC,EAAE,GAAK+B,MAAM,CAAC7B,OAAO,CAAC,CAC5D4B,KAAK,CAACN,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDI,OAAO,CAACb,SAAS,CAACiB,QAAQ,CAAE,CAACF,KAAK,CAAEC,MAAM,GAAK,CAC9CD,KAAK,CAACN,KAAK,CAAGO,MAAM,CAACP,KAAK,CAACS,OAAO,CACpC,CAAC,CAAC,CACN,CACF,CAAC,CAAC,CAGF,cAAe,CAAAf,KAAK,CAACoB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}