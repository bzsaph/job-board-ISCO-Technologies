{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport api from '../../services/api';\n\n// Apply for a job (coverLetter file + CV link via FormData)\nexport const applyJob = createAsyncThunk('applications/apply', async (data, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.post('/applications', data);\n    return res.data;\n  } catch (err) {\n    var _err$response;\n    return rejectWithValue(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || {\n      message: err.message\n    });\n  }\n});\nexport const fetchCoverLetter = createAsyncThunk('applications/fetchCoverLetter', async (filename, {\n  rejectWithValue\n}) => {\n  try {\n    // fetch as blob\n    const res = await api.get(`/files/${filename}`, {\n      responseType: 'blob'\n    });\n    // convert to URL for browser\n    const url = window.URL.createObjectURL(res.data);\n    return url;\n  } catch (err) {\n    var _err$response2;\n    return rejectWithValue(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.data) || {\n      message: err.message\n    });\n  }\n});\nexport const getApplicationsForJob = createAsyncThunk('applications/myApplications', async (userId, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.get(`/applications/mine/${userId}`);\n    return res.data; // expecting JSON array\n  } catch (err) {\n    var _err$response3;\n    console.error('API error:', err);\n    return rejectWithValue(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : _err$response3.data) || {\n      message: err.message\n    });\n  }\n});\n\n// Fetch applications for logged-in user\nexport const getApplicationsForUser = createAsyncThunk('applications/getMyApplications', async (_, {\n  getState,\n  rejectWithValue\n}) => {\n  try {\n    var _auth$user;\n    // Grab logged-in user ID from Redux state\n    const {\n      auth\n    } = getState();\n    const userId = (_auth$user = auth.user) === null || _auth$user === void 0 ? void 0 : _auth$user.id;\n    if (!userId) throw new Error('User not logged in');\n\n    // Call backend API\n    const res = await api.get(`/applications/mine/${userId}`);\n    return res.data; // Should be an array of applications\n  } catch (err) {\n    var _err$response4;\n    console.error('Error fetching applications:', err);\n    return rejectWithValue(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : _err$response4.data) || {\n      message: err.message\n    });\n  }\n});\n\n// Get all applications for a specific job (admin)\n\n// Fetch job details\nexport const fetchJob = createAsyncThunk('jobs/fetchJob', async (jobId, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.get(`/jobs/${jobId}`);\n    return res.data;\n  } catch (err) {\n    var _err$response5;\n    return rejectWithValue(((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : _err$response5.data) || {\n      message: err.message\n    });\n  }\n});\n\n// Update application status\nexport const updateApplicationStatus = createAsyncThunk('applications/update', async ({\n  id,\n  status\n}, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.put(`/applications/${id}`, {\n      status\n    });\n    return res.data;\n  } catch (err) {\n    var _err$response6;\n    return rejectWithValue(((_err$response6 = err.response) === null || _err$response6 === void 0 ? void 0 : _err$response6.data) || {\n      message: err.message\n    });\n  }\n});\nconst slice = createSlice({\n  name: 'applications',\n  initialState: {\n    list: [],\n    last: null,\n    status: 'idle',\n    error: null\n  },\n  reducers: {},\n  extraReducers: b => {\n    b.addCase(applyJob.fulfilled, (s, a) => {\n      s.last = a.payload;\n      s.error = null;\n    });\n    b.addCase(applyJob.rejected, (s, a) => {\n      var _a$payload;\n      s.error = ((_a$payload = a.payload) === null || _a$payload === void 0 ? void 0 : _a$payload.message) || 'Failed to apply';\n    });\n    b.addCase(getApplicationsForJob.fulfilled, (s, a) => {\n      s.list = a.payload;\n      s.error = null;\n    });\n    b.addCase(getApplicationsForJob.rejected, (s, a) => {\n      var _a$payload2;\n      s.error = ((_a$payload2 = a.payload) === null || _a$payload2 === void 0 ? void 0 : _a$payload2.message) || 'Failed to fetch applications';\n    });\n    b.addCase(updateApplicationStatus.fulfilled, (s, a) => {\n      s.list = s.list.map(x => x.id === a.payload.id ? a.payload : x);\n      s.error = null;\n    });\n    b.addCase(updateApplicationStatus.rejected, (s, a) => {\n      var _a$payload3;\n      s.error = ((_a$payload3 = a.payload) === null || _a$payload3 === void 0 ? void 0 : _a$payload3.message) || 'Failed to update status';\n    });\n  }\n});\nexport default slice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","applyJob","data","rejectWithValue","res","post","err","_err$response","response","message","fetchCoverLetter","filename","get","responseType","url","window","URL","createObjectURL","_err$response2","getApplicationsForJob","userId","_err$response3","console","error","getApplicationsForUser","_","getState","_auth$user","auth","user","id","Error","_err$response4","fetchJob","jobId","_err$response5","updateApplicationStatus","status","put","_err$response6","slice","name","initialState","list","last","reducers","extraReducers","b","addCase","fulfilled","s","a","payload","rejected","_a$payload","_a$payload2","map","x","_a$payload3","reducer"],"sources":["D:/fullstacker/job-board/frontend/src/store/slices/applicationsSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport api from '../../services/api';\n\n// Apply for a job (coverLetter file + CV link via FormData)\nexport const applyJob = createAsyncThunk(\n  'applications/apply',\n  async (data, { rejectWithValue }) => {\n    try {\n      const res = await api.post('/applications', data);\n      return res.data;\n    } catch (err) {\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\nexport const fetchCoverLetter = createAsyncThunk(\n  'applications/fetchCoverLetter',\n  async (filename, { rejectWithValue }) => {\n    try {\n      // fetch as blob\n      const res = await api.get(`/files/${filename}`, { responseType: 'blob' });\n      // convert to URL for browser\n      const url = window.URL.createObjectURL(res.data);\n      return url;\n    } catch (err) {\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\n\nexport const getApplicationsForJob = createAsyncThunk(\n  'applications/myApplications',\n  async (userId, { rejectWithValue }) => {\n    try {\n      const res = await api.get(`/applications/mine/${userId}`);\n      return res.data; // expecting JSON array\n    } catch (err) {\n      console.error('API error:', err);\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\n\n// Fetch applications for logged-in user\nexport const getApplicationsForUser = createAsyncThunk(\n  'applications/getMyApplications',\n  async (_, { getState, rejectWithValue }) => {\n    try {\n      // Grab logged-in user ID from Redux state\n      const { auth } = getState();\n      const userId = auth.user?.id;\n\n      if (!userId) throw new Error('User not logged in');\n\n      // Call backend API\n      const res = await api.get(`/applications/mine/${userId}`);\n\n      return res.data; // Should be an array of applications\n    } catch (err) {\n      console.error('Error fetching applications:', err);\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\n\n\n// Get all applications for a specific job (admin)\n\n\n// Fetch job details\nexport const fetchJob = createAsyncThunk(\n  'jobs/fetchJob',\n  async (jobId, { rejectWithValue }) => {\n    try {\n      const res = await api.get(`/jobs/${jobId}`);\n      return res.data;\n    } catch (err) {\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\n\n// Update application status\nexport const updateApplicationStatus = createAsyncThunk(\n  'applications/update',\n  async ({ id, status }, { rejectWithValue }) => {\n    try {\n      const res = await api.put(`/applications/${id}`, { status });\n      return res.data;\n    } catch (err) {\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\n\nconst slice = createSlice({\n  name: 'applications',\n  initialState: { list: [], last: null, status: 'idle', error: null },\n  reducers: {},\n  extraReducers: (b) => {\n    b.addCase(applyJob.fulfilled, (s, a) => { \n      s.last = a.payload; \n      s.error = null;\n    });\n    b.addCase(applyJob.rejected, (s, a) => { \n      s.error = a.payload?.message || 'Failed to apply'; \n    });\n\n    b.addCase(getApplicationsForJob.fulfilled, (s, a) => { \n      s.list = a.payload; \n      s.error = null;\n    });\n    b.addCase(getApplicationsForJob.rejected, (s, a) => { \n      s.error = a.payload?.message || 'Failed to fetch applications'; \n    });\n\n    b.addCase(updateApplicationStatus.fulfilled, (s, a) => { \n      s.list = s.list.map(x => x.id === a.payload.id ? a.payload : x); \n      s.error = null;\n    });\n    b.addCase(updateApplicationStatus.rejected, (s, a) => { \n      s.error = a.payload?.message || 'Failed to update status'; \n    });\n  }\n});\n\nexport default slice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}