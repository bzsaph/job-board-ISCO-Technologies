{"ast":null,"code":"import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';import api,{setAuthToken}from'../../services/api';export const login=createAsyncThunk('auth/login',async payload=>{const res=await api.post('/auth/login',payload);return res.data;});export const register=createAsyncThunk('auth/register',async payload=>{const res=await api.post('/auth/register',payload);return res.data;});const initialToken=localStorage.getItem('token');if(initialToken)setAuthToken(initialToken);const slice=createSlice({name:'auth',initialState:{token:initialToken,user:JSON.parse(localStorage.getItem('user')||'null'),status:'idle'},reducers:{logout(state){state.token=null;state.user=null;localStorage.removeItem('token');localStorage.removeItem('user');setAuthToken(null);}},extraReducers:b=>{b.addCase(login.fulfilled,(state,action)=>{state.token=action.payload.token;state.user=action.payload.user;localStorage.setItem('token',action.payload.token);localStorage.setItem('user',JSON.stringify(action.payload.user));setAuthToken(action.payload.token);});b.addCase(register.fulfilled,(state,action)=>{state.token=action.payload.token;state.user=action.payload.user;localStorage.setItem('token',action.payload.token);localStorage.setItem('user',JSON.stringify(action.payload.user));setAuthToken(action.payload.token);});}});export const updateUserProfile=createAsyncThunk('auth/updateProfile',async(payload,_ref)=>{let{getState}=_ref;const token=getState().auth.token;const res=await api.put('/auth/profile',payload,{headers:{Authorization:\"Bearer \".concat(token)}});return res.data;});const authSlice=createSlice({name:'auth',initialState:{user:null,token:null},reducers:{},extraReducers:builder=>{builder.addCase(updateUserProfile.fulfilled,(state,action)=>{state.user=action.payload;});}});export const{logout}=slice.actions;export default slice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","setAuthToken","login","payload","res","post","data","register","initialToken","localStorage","getItem","slice","name","initialState","token","user","JSON","parse","status","reducers","logout","state","removeItem","extraReducers","b","addCase","fulfilled","action","setItem","stringify","updateUserProfile","_ref","getState","auth","put","headers","Authorization","concat","authSlice","builder","actions","reducer"],"sources":["D:/fullstacker/job-board/frontend/src/store/slices/authSlice.js"],"sourcesContent":["\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport api, { setAuthToken } from '../../services/api';\n\nexport const login = createAsyncThunk('auth/login', async (payload) => {\n  const res = await api.post('/auth/login', payload);\n  return res.data;\n});\nexport const register = createAsyncThunk('auth/register', async (payload) => {\n  const res = await api.post('/auth/register', payload);\n  return res.data;\n});\n\nconst initialToken = localStorage.getItem('token');\nif (initialToken) setAuthToken(initialToken);\n\nconst slice = createSlice({\n  name: 'auth',\n  initialState: { token: initialToken, user: JSON.parse(localStorage.getItem('user')||'null'), status: 'idle' },\n  reducers: {\n    logout(state) {\n      state.token = null; state.user = null;\n      localStorage.removeItem('token'); localStorage.removeItem('user');\n      setAuthToken(null);\n    }\n  },\n  extraReducers: (b) => {\n    b.addCase(login.fulfilled, (state, action) => {\n      state.token = action.payload.token; state.user = action.payload.user;\n      localStorage.setItem('token', action.payload.token);\n      localStorage.setItem('user', JSON.stringify(action.payload.user));\n      setAuthToken(action.payload.token);\n    });\n    b.addCase(register.fulfilled, (state, action) => {\n      state.token = action.payload.token; state.user = action.payload.user;\n      localStorage.setItem('token', action.payload.token);\n      localStorage.setItem('user', JSON.stringify(action.payload.user));\n      setAuthToken(action.payload.token);\n    });\n  }\n});\n\n\nexport const updateUserProfile = createAsyncThunk(\n  'auth/updateProfile',\n  async (payload, { getState }) => {\n    const token = getState().auth.token;\n    const res = await api.put('/auth/profile', payload, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    return res.data;\n  }\n);\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState: { user: null, token: null },\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(updateUserProfile.fulfilled, (state, action) => {\n      state.user = action.payload;\n    });\n  },\n});\n\nexport const { logout } = slice.actions;\nexport default slice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}