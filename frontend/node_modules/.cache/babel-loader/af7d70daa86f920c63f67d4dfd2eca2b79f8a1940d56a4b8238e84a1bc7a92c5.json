{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport api from '../../services/api';\n\n// Apply for a job (with files)\nexport const applyJob = createAsyncThunk('applications/apply', async (formData, {\n  getState,\n  rejectWithValue\n}) => {\n  try {\n    const token = getState().auth.token;\n    if (!token) throw new Error('User not logged in');\n    const res = await api.post('/applications', formData, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'multipart/form-data' // required for files\n      }\n    });\n    return res.data;\n  } catch (err) {\n    var _err$response;\n    // Return backend error message for UI\n    return rejectWithValue(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || {\n      message: err.message\n    });\n  }\n});\nexport const fetchJob = async () => {\n  try {\n    const res = await api.get(`/jobs/${jobId}`);\n    setJob(res.data);\n  } catch (err) {\n    console.error('Failed to fetch job:', err);\n  }\n};\nif (jobId) fetchJob();\n\n// Get all applications for a job\nexport const getApplicationsForJob = createAsyncThunk('applications/forJob', async (jobId, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.get(`/applications/job/${jobId}`);\n    return res.data;\n  } catch (err) {\n    var _err$response2;\n    return rejectWithValue(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.data) || {\n      message: err.message\n    });\n  }\n});\n\n// Update application status\nexport const updateApplicationStatus = createAsyncThunk('applications/update', async ({\n  id,\n  status\n}, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.put(`/applications/${id}`, {\n      status\n    });\n    return res.data;\n  } catch (err) {\n    var _err$response3;\n    return rejectWithValue(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : _err$response3.data) || {\n      message: err.message\n    });\n  }\n});\nconst slice = createSlice({\n  name: 'applications',\n  initialState: {\n    list: [],\n    status: 'idle',\n    last: null,\n    error: null\n  },\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(applyJob.fulfilled, (state, action) => {\n      state.last = action.payload;\n      state.error = null;\n    }).addCase(applyJob.rejected, (state, action) => {\n      var _action$payload;\n      state.error = ((_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.message) || 'Failed to apply';\n    }).addCase(getApplicationsForJob.fulfilled, (state, action) => {\n      state.list = action.payload;\n      state.error = null;\n    }).addCase(getApplicationsForJob.rejected, (state, action) => {\n      var _action$payload2;\n      state.error = ((_action$payload2 = action.payload) === null || _action$payload2 === void 0 ? void 0 : _action$payload2.message) || 'Failed to fetch applications';\n    }).addCase(updateApplicationStatus.fulfilled, (state, action) => {\n      state.list = state.list.map(x => x.id === action.payload.id ? action.payload : x);\n      state.error = null;\n    }).addCase(updateApplicationStatus.rejected, (state, action) => {\n      var _action$payload3;\n      state.error = ((_action$payload3 = action.payload) === null || _action$payload3 === void 0 ? void 0 : _action$payload3.message) || 'Failed to update status';\n    });\n  }\n});\nexport default slice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","applyJob","formData","getState","rejectWithValue","token","auth","Error","res","post","headers","Authorization","data","err","_err$response","response","message","fetchJob","get","jobId","setJob","console","error","getApplicationsForJob","_err$response2","updateApplicationStatus","id","status","put","_err$response3","slice","name","initialState","list","last","reducers","extraReducers","builder","addCase","fulfilled","state","action","payload","rejected","_action$payload","_action$payload2","map","x","_action$payload3","reducer"],"sources":["D:/fullstacker/job-board/frontend/src/store/slices/applicationsSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport api from '../../services/api';\n\n// Apply for a job (with files)\nexport const applyJob = createAsyncThunk(\n  'applications/apply',\n  async (formData, { getState, rejectWithValue }) => {\n    try {\n      const token = getState().auth.token;\n      if (!token) throw new Error('User not logged in');\n\n      const res = await api.post('/applications', formData, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'multipart/form-data', // required for files\n        },\n      });\n\n      return res.data;\n    } catch (err) {\n      // Return backend error message for UI\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\nexport  const fetchJob = async () => {\n      try {\n        const res = await api.get(`/jobs/${jobId}`);\n        setJob(res.data);\n      } catch (err) {\n        console.error('Failed to fetch job:', err);\n      }\n    };\n    if (jobId) fetchJob();\n\n// Get all applications for a job\nexport const getApplicationsForJob = createAsyncThunk(\n  'applications/forJob',\n  async (jobId, { rejectWithValue }) => {\n    try {\n      const res = await api.get(`/applications/job/${jobId}`);\n     \n      return res.data;\n    } catch (err) {\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\n\n// Update application status\nexport const updateApplicationStatus = createAsyncThunk(\n  'applications/update',\n  async ({ id, status }, { rejectWithValue }) => {\n    try {\n      const res = await api.put(`/applications/${id}`, { status });\n      return res.data;\n    } catch (err) {\n      return rejectWithValue(err.response?.data || { message: err.message });\n    }\n  }\n);\n\nconst slice = createSlice({\n  name: 'applications',\n  initialState: {\n    list: [],\n    status: 'idle',\n    last: null,\n    error: null,\n  },\n  reducers: {},\n  extraReducers: (builder) => {\n    builder\n      .addCase(applyJob.fulfilled, (state, action) => {\n        state.last = action.payload;\n        state.error = null;\n      })\n      .addCase(applyJob.rejected, (state, action) => {\n        state.error = action.payload?.message || 'Failed to apply';\n      })\n      .addCase(getApplicationsForJob.fulfilled, (state, action) => {\n        state.list = action.payload;\n        state.error = null;\n      })\n      .addCase(getApplicationsForJob.rejected, (state, action) => {\n        state.error = action.payload?.message || 'Failed to fetch applications';\n      })\n      .addCase(updateApplicationStatus.fulfilled, (state, action) => {\n        state.list = state.list.map((x) =>\n          x.id === action.payload.id ? action.payload : x\n        );\n        state.error = null;\n      })\n      .addCase(updateApplicationStatus.rejected, (state, action) => {\n        state.error = action.payload?.message || 'Failed to update status';\n      });\n  },\n});\n\nexport default slice.reducer;\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,GAAG,MAAM,oBAAoB;;AAEpC;AACA,OAAO,MAAMC,QAAQ,GAAGF,gBAAgB,CACtC,oBAAoB,EACpB,OAAOG,QAAQ,EAAE;EAAEC,QAAQ;EAAEC;AAAgB,CAAC,KAAK;EACjD,IAAI;IACF,MAAMC,KAAK,GAAGF,QAAQ,CAAC,CAAC,CAACG,IAAI,CAACD,KAAK;IACnC,IAAI,CAACA,KAAK,EAAE,MAAM,IAAIE,KAAK,CAAC,oBAAoB,CAAC;IAEjD,MAAMC,GAAG,GAAG,MAAMR,GAAG,CAACS,IAAI,CAAC,eAAe,EAAEP,QAAQ,EAAE;MACpDQ,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUN,KAAK,EAAE;QAChC,cAAc,EAAE,qBAAqB,CAAE;MACzC;IACF,CAAC,CAAC;IAEF,OAAOG,GAAG,CAACI,IAAI;EACjB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAC,aAAA;IACZ;IACA,OAAOV,eAAe,CAAC,EAAAU,aAAA,GAAAD,GAAG,CAACE,QAAQ,cAAAD,aAAA,uBAAZA,aAAA,CAAcF,IAAI,KAAI;MAAEI,OAAO,EAAEH,GAAG,CAACG;IAAQ,CAAC,CAAC;EACxE;AACF,CACF,CAAC;AACD,OAAQ,MAAMC,QAAQ,GAAG,MAAAA,CAAA,KAAY;EAC/B,IAAI;IACF,MAAMT,GAAG,GAAG,MAAMR,GAAG,CAACkB,GAAG,CAAC,SAASC,KAAK,EAAE,CAAC;IAC3CC,MAAM,CAACZ,GAAG,CAACI,IAAI,CAAC;EAClB,CAAC,CAAC,OAAOC,GAAG,EAAE;IACZQ,OAAO,CAACC,KAAK,CAAC,sBAAsB,EAAET,GAAG,CAAC;EAC5C;AACF,CAAC;AACD,IAAIM,KAAK,EAAEF,QAAQ,CAAC,CAAC;;AAEzB;AACA,OAAO,MAAMM,qBAAqB,GAAGxB,gBAAgB,CACnD,qBAAqB,EACrB,OAAOoB,KAAK,EAAE;EAAEf;AAAgB,CAAC,KAAK;EACpC,IAAI;IACF,MAAMI,GAAG,GAAG,MAAMR,GAAG,CAACkB,GAAG,CAAC,qBAAqBC,KAAK,EAAE,CAAC;IAEvD,OAAOX,GAAG,CAACI,IAAI;EACjB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAW,cAAA;IACZ,OAAOpB,eAAe,CAAC,EAAAoB,cAAA,GAAAX,GAAG,CAACE,QAAQ,cAAAS,cAAA,uBAAZA,cAAA,CAAcZ,IAAI,KAAI;MAAEI,OAAO,EAAEH,GAAG,CAACG;IAAQ,CAAC,CAAC;EACxE;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAMS,uBAAuB,GAAG1B,gBAAgB,CACrD,qBAAqB,EACrB,OAAO;EAAE2B,EAAE;EAAEC;AAAO,CAAC,EAAE;EAAEvB;AAAgB,CAAC,KAAK;EAC7C,IAAI;IACF,MAAMI,GAAG,GAAG,MAAMR,GAAG,CAAC4B,GAAG,CAAC,iBAAiBF,EAAE,EAAE,EAAE;MAAEC;IAAO,CAAC,CAAC;IAC5D,OAAOnB,GAAG,CAACI,IAAI;EACjB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAgB,cAAA;IACZ,OAAOzB,eAAe,CAAC,EAAAyB,cAAA,GAAAhB,GAAG,CAACE,QAAQ,cAAAc,cAAA,uBAAZA,cAAA,CAAcjB,IAAI,KAAI;MAAEI,OAAO,EAAEH,GAAG,CAACG;IAAQ,CAAC,CAAC;EACxE;AACF,CACF,CAAC;AAED,MAAMc,KAAK,GAAGhC,WAAW,CAAC;EACxBiC,IAAI,EAAE,cAAc;EACpBC,YAAY,EAAE;IACZC,IAAI,EAAE,EAAE;IACRN,MAAM,EAAE,MAAM;IACdO,IAAI,EAAE,IAAI;IACVZ,KAAK,EAAE;EACT,CAAC;EACDa,QAAQ,EAAE,CAAC,CAAC;EACZC,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAACrC,QAAQ,CAACsC,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MAC9CD,KAAK,CAACN,IAAI,GAAGO,MAAM,CAACC,OAAO;MAC3BF,KAAK,CAAClB,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDgB,OAAO,CAACrC,QAAQ,CAAC0C,QAAQ,EAAE,CAACH,KAAK,EAAEC,MAAM,KAAK;MAAA,IAAAG,eAAA;MAC7CJ,KAAK,CAAClB,KAAK,GAAG,EAAAsB,eAAA,GAAAH,MAAM,CAACC,OAAO,cAAAE,eAAA,uBAAdA,eAAA,CAAgB5B,OAAO,KAAI,iBAAiB;IAC5D,CAAC,CAAC,CACDsB,OAAO,CAACf,qBAAqB,CAACgB,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MAC3DD,KAAK,CAACP,IAAI,GAAGQ,MAAM,CAACC,OAAO;MAC3BF,KAAK,CAAClB,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDgB,OAAO,CAACf,qBAAqB,CAACoB,QAAQ,EAAE,CAACH,KAAK,EAAEC,MAAM,KAAK;MAAA,IAAAI,gBAAA;MAC1DL,KAAK,CAAClB,KAAK,GAAG,EAAAuB,gBAAA,GAAAJ,MAAM,CAACC,OAAO,cAAAG,gBAAA,uBAAdA,gBAAA,CAAgB7B,OAAO,KAAI,8BAA8B;IACzE,CAAC,CAAC,CACDsB,OAAO,CAACb,uBAAuB,CAACc,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MAC7DD,KAAK,CAACP,IAAI,GAAGO,KAAK,CAACP,IAAI,CAACa,GAAG,CAAEC,CAAC,IAC5BA,CAAC,CAACrB,EAAE,KAAKe,MAAM,CAACC,OAAO,CAAChB,EAAE,GAAGe,MAAM,CAACC,OAAO,GAAGK,CAChD,CAAC;MACDP,KAAK,CAAClB,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDgB,OAAO,CAACb,uBAAuB,CAACkB,QAAQ,EAAE,CAACH,KAAK,EAAEC,MAAM,KAAK;MAAA,IAAAO,gBAAA;MAC5DR,KAAK,CAAClB,KAAK,GAAG,EAAA0B,gBAAA,GAAAP,MAAM,CAACC,OAAO,cAAAM,gBAAA,uBAAdA,gBAAA,CAAgBhC,OAAO,KAAI,yBAAyB;IACpE,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,eAAec,KAAK,CAACmB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}